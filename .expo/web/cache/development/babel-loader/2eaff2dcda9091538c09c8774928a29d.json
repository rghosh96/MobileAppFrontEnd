{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _actions = require(\"../../redux/actions\");\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _asyncStorage = _interopRequireDefault(require(\"@react-native-community/async-storage\"));\n\nvar _native = require(\"styled-components/native\");\n\nvar _masterStyle = require(\"../../theming/masterStyle\");\n\nvar _createStyle = require(\"../../theming/createStyle\");\n\nvar _signupStyle = require(\"../../theming/signupStyle\");\n\nvar _formik = require(\"formik\");\n\nvar yup = _interopRequireWildcard(require(\"yup\"));\n\nvar _reactNativeKeyboardAwareScrollView = require(\"react-native-keyboard-aware-scroll-view\");\n\nvar _lottieReactNative = _interopRequireDefault(require(\"lottie-react-native\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _jsxFileName = \"/Users/rashighosh/Desktop/MobileAppFrontEnd/components/SigningUp/SignUp.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar SignUpSchema = yup.object({\n  user: yup.string().required('required!!!'),\n  password: yup.string().required('required!!!')\n});\n\nvar SignUp = function (_Component) {\n  (0, _inherits2.default)(SignUp, _Component);\n\n  var _super = _createSuper(SignUp);\n\n  function SignUp() {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, SignUp);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      loaded: false,\n      success: false,\n      error: '',\n      alreadyInDB: false\n    };\n    return _this;\n  }\n\n  (0, _createClass2.default)(SignUp, [{\n    key: \"getToken\",\n    value: function getToken(user) {\n      var userId;\n      return _regenerator.default.async(function getToken$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              console.log(\"before getting item\");\n              _context.next = 4;\n              return _regenerator.default.awrap(_asyncStorage.default.getItem(\"user\"));\n\n            case 4:\n              userId = _context.sent;\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(\"Something went wrong\", _context.t0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 7]], Promise);\n    }\n  }, {\n    key: \"storeToken\",\n    value: function storeToken(user) {\n      return _regenerator.default.async(function storeToken$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return _regenerator.default.awrap(_asyncStorage.default.setItem(\"user\", user));\n\n            case 3:\n              _context2.next = 8;\n              break;\n\n            case 5:\n              _context2.prev = 5;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(\"Something went wrong\", _context2.t0);\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, [[0, 5]], Promise);\n    }\n  }, {\n    key: \"authenticate\",\n    value: function authenticate(info) {\n      var _this2 = this;\n\n      console.log(\"in authenticate\");\n      console.log(info);\n      var user = {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user: info.user.toLowerCase(),\n          password: info.password\n        })\n      };\n      fetch(\"http://mobile-app.ddns.uark.edu/LDAP/login\", user).then(function (response) {\n        return response.text();\n      }).then(function (json) {\n        var data = JSON.parse(json);\n        console.log(data);\n\n        _this2.setState({\n          error: data.result\n        });\n\n        if (data.isError === false && data.result.includes(\"was added\")) {\n          _this2.setState({\n            success: true\n          });\n        } else if (data.result.includes(\"already in db\")) {\n          _this2.setState({\n            success: true,\n            alreadyInDB: true\n          });\n        } else {\n          if (data.result.includes(\"Incorrect authentication\")) {\n            _this2.setState({\n              success: false\n            });\n          }\n        }\n      }).catch(function (error) {\n        return console.error(error);\n      }).finally(function () {\n        if (_this2.state.success === true) {\n          _this2.storeToken(info.user.toLowerCase());\n\n          console.log(\"successfully stored user in async storage!\");\n\n          _this2.getToken();\n\n          if (_this2.state.alreadyInDB === true) {\n            _this2.props.navigation.navigate(\"Dashboard\", {\n              user: info.user.toLowerCase()\n            });\n          } else {\n            _this2.props.navigation.navigate(\"GetUserInterests\", {\n              user: info.user.toLowerCase()\n            });\n          }\n        } else {\n          _reactNative.Alert.alert(\"Hmmm...\", _this2.state.error, [{\n            text: \"let me double check ..\",\n            onPress: function onPress() {\n              return console.log(\"okay pressed\");\n            }\n          }], {\n            cancelable: false\n          });\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          data = _this$state.data,\n          loaded = _this$state.loaded;\n      return _react.default.createElement(_native.ThemeProvider, {\n        theme: this.props.theme,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }\n      }, _react.default.createElement(_reactNativeKeyboardAwareScrollView.KeyboardAwareScrollView, {\n        style: {\n          backgroundColor: this.props.theme.BG_COLOR\n        },\n        resetScrollToCoords: {\n          x: 0,\n          y: 0\n        },\n        scrollEnabled: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 17\n        }\n      }, _react.default.createElement(_signupStyle.SignUpContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 17\n        }\n      }, _react.default.createElement(_formik.Formik, {\n        initialValues: {\n          user: '',\n          password: ''\n        },\n        validationSchema: SignUpSchema,\n        onSubmit: function onSubmit(values) {\n          _this3.authenticate(values);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 25\n        }\n      }, function (props) {\n        return _react.default.createElement(_signupStyle.FormArea, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 33\n          }\n        }, _react.default.createElement(_masterStyle.Center, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 37\n          }\n        }, _react.default.createElement(_lottieReactNative.default, {\n          style: {\n            height: 200\n          },\n          source: require('../../assets/signup.json'),\n          autoPlay: true,\n          loop: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 45\n          }\n        })), _react.default.createElement(_createStyle.HeaderContainer, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 37\n          }\n        }, _react.default.createElement(_masterStyle.HeaderText, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 41\n          }\n        }, \"sign in\"), _react.default.createElement(_masterStyle.Subtitle, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 41\n          }\n        }, \"what?! no sign up? nope! just sign in with your uark credentials!\")), _react.default.createElement(_signupStyle.FormInput, {\n          placeholder: \"UARK username (do NOT include @uark.edu)\",\n          placeholderTextColor: _this3.props.theme.LIGHT_GREY,\n          onChangeText: props.handleChange('user'),\n          value: props.values.user,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 37\n          }\n        }), _react.default.createElement(_signupStyle.ErrorText, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 37\n          }\n        }, props.touched.user && props.errors.user), _react.default.createElement(_signupStyle.FormInput, {\n          placeholder: \"UARK password\",\n          placeholderTextColor: _this3.props.theme.LIGHT_GREY,\n          onChangeText: props.handleChange('password'),\n          value: props.values.password,\n          secureTextEntry: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 37\n          }\n        }), _react.default.createElement(_signupStyle.ErrorText, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 37\n          }\n        }, props.touched.password && props.errors.password), _react.default.createElement(_masterStyle.Button, {\n          title: \"Submit\",\n          onPress: function onPress() {\n            return props.handleSubmit();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 37\n          }\n        }, _react.default.createElement(_masterStyle.ButtonText, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 41\n          }\n        }, \"get started!\")));\n      }))));\n    }\n  }]);\n  return SignUp;\n}(_react.Component);\n\nfunction mapStateToProps(state) {\n  return {\n    theme: state.themeReducer.theme\n  };\n}\n\nvar _default = (0, _reactRedux.connect)(mapStateToProps, {\n  pickTheme: _actions.pickTheme\n})(SignUp);\n\nexports.default = _default;","map":{"version":3,"sources":["/Users/rashighosh/Desktop/MobileAppFrontEnd/components/SigningUp/SignUp.js"],"names":["SignUpSchema","yup","object","user","string","required","password","SignUp","state","loaded","success","error","alreadyInDB","console","log","AsyncStorage","getItem","userId","setItem","info","method","headers","body","JSON","stringify","toLowerCase","fetch","then","response","text","json","data","parse","setState","result","isError","includes","catch","finally","storeToken","getToken","props","navigation","navigate","Alert","alert","onPress","cancelable","theme","backgroundColor","BG_COLOR","x","y","values","authenticate","height","require","LIGHT_GREY","handleChange","touched","errors","handleSubmit","Component","mapStateToProps","themeReducer","pickTheme"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { pickTheme } from '../../redux/actions'\nimport { connect } from 'react-redux';\nimport AsyncStorage from '@react-native-community/async-storage'\nimport { ThemeProvider } from 'styled-components/native';\nimport { HeaderText, Subtitle, Button, ButtonText, Center } from '../../theming/masterStyle'\nimport { HeaderContainer } from '../../theming/createStyle'\nimport { FormArea, SignUpContent, FormInput, ErrorText } from '../../theming/signupStyle'\nimport { Formik } from 'formik'\nimport * as yup from 'yup';\nimport { KeyboardAwareScrollView } from 'react-native-keyboard-aware-scroll-view'\nimport LottieView from 'lottie-react-native';\nimport { Alert } from \"react-native\";\n\n// form validation\nconst SignUpSchema = yup.object({\n    user: yup.string().required('required!!!'),\n    password: yup.string().required('required!!!')\n})\n\nclass SignUp extends Component {\n    state = {\n        loaded: false,\n        success: false,\n        error: '',\n        alreadyInDB: false\n      }\n\n      async getToken(user) {\n        try {\n            console.log(\"before getting item\");\n          let userId = await AsyncStorage.getItem(\"user\");\n        } catch (error) {\n          console.log(\"Something went wrong\", error);\n        }\n      }  \n\n      async storeToken(user) {\n        try {\n           await AsyncStorage.setItem(\"user\", user);\n        } catch (error) {\n          console.log(\"Something went wrong\", error);\n        }\n      }\n    // calls api to authenticate username & password\n    authenticate(info) {\n        console.log(\"in authenticate\")\n        console.log(info)\n        // create user body to send to api\n        const user={\n            method: 'POST',\n            headers:{'Content-Type': 'application/json'},\n            body: JSON.stringify({user: info.user.toLowerCase(), password:info.password})\n        }\n        // call api endpoint, sending in user to add to db\n        fetch(`http://mobile-app.ddns.uark.edu/LDAP/login`, user)\n            .then((response) => response.text())\n            .then((json) => {\n                // parse the response & extract data\n                let data = JSON.parse(json)\n                console.log(data)\n                this.setState({error: data.result})\n                // if there was no error, and user was successfully added, success!\n                if (data.isError === false && data.result.includes(\"was added\")) {\n                    this.setState({success: true})\n                } else if (data.result.includes(\"already in db\")) {\n                    this.setState({success: true, alreadyInDB: true})\n                } else {\n                    if (data.result.includes(\"Incorrect authentication\")) {\n                        this.setState({success: false})\n                    }\n                }\n            })\n            .catch((error) => console.error(error))\n            .finally(() => {\n                // if successful addition to db, navigate to create profile\n                if (this.state.success === true) {\n                    this.storeToken(info.user.toLowerCase())\n                     console.log(\"successfully stored user in async storage!\")\n                     this.getToken();\n\n                     if (this.state.alreadyInDB === true) {\n                        this.props.navigation.navigate(\n                            \"Dashboard\",\n                            {user: info.user.toLowerCase()});\n                     } else {\n                    this.props.navigation.navigate(\n                        \"GetUserInterests\",\n                        {user: info.user.toLowerCase()});\n                    }\n                } else {\n                    Alert.alert(\n                        \"Hmmm...\",\n                        this.state.error,\n                        [\n                          { text: \"let me double check ..\", onPress: () => console.log(\"okay pressed\") }\n                        ],\n                        { cancelable: false }\n                      );\n                }\n                    \n            })\n    }\n    render() {\n        const { data, loaded } = this.state;\n        return (\n            <ThemeProvider theme={ this.props.theme }>\n                <KeyboardAwareScrollView\n                style={{ backgroundColor: this.props.theme.BG_COLOR }}\n                resetScrollToCoords={{ x: 0, y: 0 }}\n                scrollEnabled={false}\n                >\n                <SignUpContent>     \n                        <Formik \n                            initialValues={{ user: '', password: ''}}\n                            validationSchema={SignUpSchema}\n                            onSubmit={(values) => {\n                                this.authenticate(values)\n                            }}\n                        >\n                            {/* get access to props of Formik */}\n                            {(props) => (\n                                <FormArea>\n                                    <Center><LottieView style={{height: 200}}source={require('../../assets/signup.json')} autoPlay loop /></Center> \n                                    <HeaderContainer>\n                                        <HeaderText>sign in</HeaderText>\n                                        <Subtitle>what?! no sign up? nope! just sign in with your\n                                            uark credentials!\n                                        </Subtitle>\n                                    </HeaderContainer>\n                                    <FormInput \n                                        placeholder='UARK username (do NOT include @uark.edu)' \n                                        placeholderTextColor={this.props.theme.LIGHT_GREY}\n                                        onChangeText={props.handleChange('user')} \n                                        value = {props.values.user}\n                                    />\n                                    <ErrorText>{props.touched.user && props.errors.user }</ErrorText>\n                                    <FormInput \n                                        placeholder='UARK password' \n                                        placeholderTextColor={this.props.theme.LIGHT_GREY}\n                                        onChangeText={props.handleChange('password')} \n                                        value = {props.values.password}\n                                        secureTextEntry\n                                    />\n                                    <ErrorText>{props.touched.password && props.errors.password }</ErrorText>\n                                    <Button title=\"Submit\" onPress={() => props.handleSubmit()}>\n                                        <ButtonText>get started!</ButtonText>\n                                    </Button>\n                                </FormArea>\n                            )}\n                        </Formik>\n                </SignUpContent>\n                </KeyboardAwareScrollView>\n            </ThemeProvider>\n        );\n    }\n}\n\nfunction mapStateToProps(state) {\n    return {\n        theme: state.themeReducer.theme\n    }\n}\n\nexport default connect(mapStateToProps, {pickTheme})(SignUp);\n\n\n\n\n"]},"metadata":{},"sourceType":"script"}